---
title: Web Scraping Using R
author: Mallick Hossain
date: '2017-12-16'
slug: scraping-with-rvest
draft: true
output:
  blogdown::html_page:
    toc: true
categories:
  - R
  - Scraping
  - rvest
tags: []
---

# Web Scraping
For the uninitiated, web scraping is a way of extracting data from websites. Why would anyone be interested in this? There is a lot of data made available on the web, but it is not always in easily downloadable formats. Or, as is more often the case, a human can only highlight, copy, and paste so many times before carpal tunnel sets in and one's mind begins to melt. We created software so computers can do the tasks we do not want to, so let's take advantage of that!

In this post, I will guide you through using Hadley Wickham's `rvest` package to scrape prices from Walmart.com. I am currently collecting this data for a personal research project, but if you are interested just contact me!

For an advanced version of scraping (extracting JavaScript elements), see my other web scraping [tutorial](www.mallickhossain.com/2017/12/scraping-javascript). 

# Project Background
Online prices can be different from offline prices and for a long time, large companies like Target and Walmart did not match their online prices (they only started in 2013 and 2014, respectively).^[See Target's January 8, 2013 press release "Target Announces New Year-Round Price Match of Online Retailers"] ^[See Walmart's November 19, 2014 press release "Walmart Statement Regarding Online Price Match Policy"] Even now, Macy's still does not match the prices on their website.^[See [Macy's Pricing Policy for Online Merchandise](https://www.customerservice-macys.com/app/answers/detail/a_id/14/~/pricing-policy-for-online-merchandise) accessed December 16, 2017.]

In order to get the offline prices of goods, you would have to go into the store and compare the shelf price to the website price. However, in November 2017, Walmart actually increased its online prices and posted both the online and in-store price on its website.^[See November 12, 2017 WSJ article [Now Featured on Wal-Martâ€™s Website: Higher Prices Than Stores](https://www.wsj.com/articles/now-featured-on-wal-marts-website-higher-prices-1510517219)] This change creates a unique opportunity to generate a fascinating data set of online and offline prices from one of the world's largest retailers. 

![](/img/walmartPrice.png)

# How Scraping Works
There are a wide variety of web scraping tools. `rvest` uses HTML scraping, which means that after feeding it a URL, it can scrape various elements of the webpage directly from the underlying HTML code. When using this strategy, you must put in the effort to identify the HTML elements that you want to extract. You could do this by directly looking at the HTML and then figuring out which attributes to scrape. However, there is an easier way. The [SelectorGadget](http://selectorgadget.com/) tool allows you to click on the elements you want to extract and it tells you the HTML attributes that are underlying the element you clicked. 

# Getting Prices
For this exercise, I will get the prices of Kraft Macaroni and Cheese.^[It's the cheesiest.] Before beginning, I looked at what data was available on the page and identified specific fields that I wanted to capture. Below are the fields I will capture:

* Date
* Product Name 
* Online Price
* In-Store Price (if available)
* Online Sale Price (if applicable)
* In-Store Sale Price (if applicable)

```{r}
library(rvest)
kraft <- "https://www.walmart.com/search/?query=kraft%20macaroni%20and%20cheese"
price <- read_html(kraft) %>% 
  html_nodes(".product-title-link , .clearfix")


trip <- "http://www.tripadvisor.com/Hotel_Review-g37209-d1762915-Reviews-JW_Marriott_Indianapolis-Indianapolis_Indiana.html"
apple <- read_html(trip) %>% 
  html_nodes(".partial_entry")

pear <- read_html(trip) %>%
  html_nodes("#REVIEWS .innerBubble")
```

